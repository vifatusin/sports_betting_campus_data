---
title: "gambling_policy_schools_analysis"
author: "Victoria Ifatusin"
date: "11/2/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Sports Betting & Gambling Policies on College Campuses

To Fill In........
.......
.......
.......

```{r}
# Turn off scientific notation
options(scipen=999)
# Loading tidyverse and other packages.
library(tidyverse)
library(janitor)
library(ggplot2)
library(dplyr)
```

# Our Data

Student reporters in the Povich Center reached out to all 231 Division I public universities to ask for campus policies regarding gambling. The information received was put into an Google Forms sheet. 

```{r}
# Overall Cleaning

## Loading the updated tracker as of Nov. 30, 2022, and cleaning it by renaming the column names.  
uni_policies_updated <- read_csv("policy_tracker_11302022.csv") %>% 
  clean_names() %>% 
  rename(school_policy_exist =
           does_the_school_have_a_policy_on_sports_gambling_betting_that_extends_beyond_ncaa_policy) %>%
  rename(allowed = is_sports_gambling_betting_allowed) %>% 
  rename(state_abb = state) %>% 
  rename(state_law = does_the_response_cite_state_law) %>% 
  rename(covered = who_is_covered) %>% 
  rename(campus_allowed = is_sports_gambling_allowed_on_or_off_campus) %>% 
  rename(detail = detail_if_there_isnt_any_detail_put_n_a) %>% 
  rename(interesting = rate_the_policys_interestingness_on_a_scale_from_1_5) %>% 
  rename(specifics = give_specific_key_words_or_phrases) %>% 
  rename(advert_policy_exist =
           does_the_school_have_a_policy_on_the_advertising_or_promotion_of_gambling_or_gaming_products_and_services) %>% 
  rename(detail_advert = briefly_describe_the_advertising_policy_if_theres_no_policy_or_its_unclear_please_put_n_a)

## There was a school that had the wrong state in it, and a school had been entered twice. 
uni_policies_updated[43, 3] = "SC"
uni_policies_updated <- uni_policies_updated [-66,]

# Adding in new columns:

## The full spelling of the states
uni_policies_updated <- uni_policies_updated %>% 
  mutate(state = case_when(
    state_abb == "AL" ~ "Alabama", state_abb == "AK" ~ "Alaska", state_abb == "AZ" ~ "Arizona", 
    state_abb == "AR" ~ "Arkansas", state_abb == "CA" ~ "California", state_abb == "CO" ~ "Colorado",
    state_abb == "CT" ~ "Connecticut", state_abb == "DE" ~ "Delaware", state_abb == "FL" ~ "Florida",
    state_abb == "GA" ~ "Georgia", state_abb == "HI" ~ "Hawaii", state_abb == "ID" ~ "Idaho", 
    state_abb == "IL" ~ "Illinois", state_abb == "IN" ~ "Indiana", state_abb == "IA" ~ "Iowa", 
    state_abb == "KS" ~ "Kansas", state_abb == "KY" ~ "Kentucky", state_abb == "LA" ~ "Louisiana", 
    state_abb == "ME" ~ "Maine", state_abb == "MD" ~ "Maryland", state_abb == "MA" ~ "Massachusetts",
    state_abb == "MI" ~ "Michigan", state_abb == "MN" ~ "Minnesota", state_abb == "MS" ~ "Mississippi",
    state_abb == "MO" ~ "Missouri", state_abb == "MT" ~ "Montana", state_abb == "NE" ~ "Nebraska",
    state_abb == "NV" ~ "Nevada", state_abb == "NH" ~ "New Hampshire", 
    state_abb == "NJ" ~ "New Jersey", state_abb == "NM" ~ "New Mexico", state_abb == "NY" ~ "New York",
    state_abb == "NC" ~ "North Carolina", state_abb == "ND" ~ "North Dakota", 
    state_abb == "OH" ~ "Ohio", state_abb == "OK" ~ "Oklahoma", state_abb == "OR" ~ "Oregon",
    state_abb == "PA" ~ "Pennsylvania", state_abb == "RI" ~ "Rhode Island", 
    state_abb == "SC" ~ "South Carolina", state_abb == "SD" ~ "South Dakota", 
    state_abb == "TN" ~ "Tennessee", state_abb == "TX" ~ "Texas", state_abb == "UT" ~ "Utah",
    state_abb == "VT" ~ "Vermont", state_abb == "VA" ~ "Virginia", state_abb == "WA" ~ "Washington",
    state_abb == "WV" ~ "West Virginia", state_abb == "WI" ~ "Wisconsin", state_abb == "WY" ~ "Wyoming"
  ))

## The full name of the school
uni_policies_updated <- uni_policies_updated %>% 
  mutate(school_name = case_when(
    school == "Fresno State" ~ "California State University-Fresno", 
    school == "University of Southern Mississippi" ~ "University of Southern Mississippi",
    school == "Wright State" ~ "Wright State University-Main Campus",
    school == "LA Tech" ~ "Louisiana Tech University",
    school == "Kennesaw State" ~ "Kennesaw State University",
    school == "University of California, Berkely" ~ "University of California-Berkeley",
    school == "Wintrhop" ~ "Winthrop University",
    school == "Bowling Green" ~ "Bowling Green State University-Main Campus",
    school == "University of Georgia" ~ "University of Georgia",
    school == "South Carolina Upstate" ~ "University of South Carolina-Upstate",
    school == "Cal State Bakersfield" ~ "California State University-Bakersfield",
    school == "Cincinnati" ~ "University of Cincinnati-Main Campus",
    school == "Clemson" ~ "Clemson University",
    school == "Georgia Tech" ~ "Georgia Institute of Technology-Main Campus",
    school == "South Carolina" ~ "University of South Carolina-Columbia",
    school == "Cal State, Fullerton" ~ "California State University-Fullerton",
    school == "Youngstown State" ~ "Youngstown State University",
    school == "Florida State" ~ "Florida State University",
    school == "South Dakota" ~ "University of South Dakota",
    school == "South Dakota State" ~ "South Dakota State University",
# The policy for University of Minnesota seems to be across all five campuses. I picked Twin Cities, because that seemed to be the most well known. 
    school == "University of Minnesota" ~ "University of Minnesota-Twin Cities",
    school == "North Carolina A&T" ~ "North Carolina A & T State University",
    school == "George Mason" ~ "George Mason University",
    school == "Longwood" ~ "Longwood University",
    school == "Oklahoma State" ~ "Oklahoma State University-Main Campus",
    school == "Grambling State University" ~ "Grambling State University",
    school == "Morehead State" ~ "Morehead State University",
    school == "Coppin State" ~ "Coppin State University",
    school == "Miami of Ohio" ~ "Miami University-Oxford",
    school == "UConn" ~ "University of Connecticut",
    school == "UCF" ~ "University of Central Florida",
    school == "FIU" ~ "Florida International University",
    school == "Northern Iowa" ~ "University of Northern Iowa",
    school == "Southern University" ~ "Southern University and A & M College",
    school == "University of Nebraska, Lincoln" ~ "University of Nebraska-Lincoln",
    school == "Louisiana Northwestern" ~ "Northwestern State University of Louisiana",
    school == "University of New Orleans" ~ "University of New Orleans",
    school == "University of Louisiana at Lafayette" ~ "University of Louisiana at Lafayette",
    school == "Idaho State" ~ "Idaho State University",
    school == "University of Kansas" ~ "University of Kansas",
    school == "College of Charleston" ~ "College of Charleston",
    school == "The Citadel" ~ "Citadel Military College of South Carolina",
    school == "Radford" ~ "Radford University",
    school == "William & Mary" ~ "William & Mary",
    school == "James Madison" ~ "James Madison University",
    school == "Virginia" ~ "University of Virginia-Main Campus",
    school == "Old Dominion" ~ "Old Dominion University",
    school == "UNC Charlotte" ~ "University of North Carolina at Charlotte",
    school == "Virginia Commonwealth (VCU)" ~ "Virginia Commonwealth University",
    school == "Virginia Tech" ~ "Virginia Polytechnic Institute and State University",
    school == "Western Carolina" ~ "Western Carolina University",
    school == "Eastern Washington" ~ "Eastern Washington University",
    school == "Northern Arizona" ~ "Northern Arizona University",
    school == "Arizona State" ~ "Arizona State University Campus Immersion",
    school == "University of California, Riverside" ~ "University of California-Riverside",
    school == "San JoseÃÅ State University" ~"San Jose State University", 
    school == "Long Beach" ~ "California State University-Long Beach",
    school == "Eastern Illinois" ~ "Eastern Illinois",
    school == "VMI" ~ "Virginia Military Institute",
    school == "Northern Colorado" ~ "University of Northern Colorado",
    school == "Kansas State University" ~ "Kansas State University",
    school == "University of Oregon" ~ "University of Oregon",
    school == "Georgia Southern" ~ "Georgia Southern University",
    school == "Illinois State" ~ "Illinois State University",
    school == "Northern Illinois" ~ "Northern Illinois University",
    school == "Vermont" ~ "University of Vermont",
    school == "UF" ~ "University of Florida",
    school == "FGCU" ~ "Florida Gulf Coast University",
    school == "UNF" ~ "University of North Florida",
# North Illinois comes up twice.
    school == "Northern Illinois" ~ "Northern Illinois University",
    school == "LSU" ~ "Louisiana State University and Agricultural & Mechanical College",
    school == "University of North Dakota" ~ "University of North Dakota",
    school == "Southern Illinois" ~ "Southern Illinois University-Carbondale",
    school == "University of Toledo" ~ "University of Toledo",
    school == "Western Illinois" ~ "Western Illinois University",
    school == "Illinois Chicago (UIC)" ~ "University of Illinois Chicago",
    school == "Southern Illinois Edwardsville" ~ "Southern Illinois University-Edwardsville",
    school == "Illinois" ~ "University of Illinois Urbana-Champaign",
    school == "University of Idaho" ~ "University of Idaho",
    school == "UCLA" ~ "University of California-Los Angeles",
    school == "UC Irvine" ~ "University of California-Irvine",
    school == "San Diego State" ~ "San Diego State University",
    school == "Washington State University" ~ "Washington State University",
    school == "University of New Mexico" ~ "University of New Mexico-Main Campus",
    school == "University of Iowa" ~ "University of Iowa",
    school == "Purdue" ~ "Purdue University-Main Campus",
    school == "Indiana State University" ~ "Indiana State University",
    school == "Indiana University" ~ "Indiana University-Bloomington",
    school == "Oregon State" ~ "Oregon State University",
    school == "Portland State" ~ "Portland State University",
    school == "University at Albany" ~ "SUNY at Albany",
    school == "University at Buffalo" ~ "University at Buffalo",
    school == "Stony Brook" ~ "Stony Brook University",
    school == "University of Wyoming" ~ "University of Wyoming",
    school == "Chicago State" ~ "Chicago State University",
    school == "Central Connecticut State" ~ "Central Connecticut State University",
    school == "Mississippi Valley State" ~ "Mississippi Valley State University"
  ))


## The legality of sports betting in the states. 
uni_policies_updated <- uni_policies_updated %>% 
  mutate(legal_illegal = case_when(
    state == 'Alabama' | state == 'Alaska' | state == 'California' | state == 'Florida' |
    state == 'Georgia' | state == 'Hawaii' | state == 'Idaho' | state == 'Kentucky' | 
    state == 'Minnesota' | state == 'Missouri' | state == 'Oklahoma' | state == 'South Carolina' |
    state == 'Texas' | state == 'Utah' | state == 'Vermont' ~ "illegal",
    state == 'Arizona' | state == 'Arkansas' | state == 'Colorado' | state == 'Connecticut' |
    state == 'Delaware' | state == 'Illinois' | state == 'Indiana' | state == 'Iowa' | 
    state == 'Kansas' | state == 'Louisiana' | state == 'Maine' | state == 'Maryland' | 
    state == 'Massachusetts' | state == 'Michigan' | state == 'Mississippi' | state == 'Montana' |
    state == 'Nebraska' | state == 'Nevada' | state == 'New Hampshire' | state == 'New Jersey' | 
    state == 'New Mexico' | state == 'New York' | state == 'North Carolina' | state == 'North Dakota' |
    state == 'Ohio' | state == 'Oregon' | state == 'Pennsylvania' | state == 'Rhode Island' | 
    state == 'South Dakota' | state == 'Tennessee' | state == 'Virginia' | state == 'Washington' |
    state == 'West Virginia' | state == 'Wisconsin' | state == 'Wyoming' ~ "legal"))

## Checking to see if any others schools have been filled in twice or more. 
uni_policies_updated %>% 
  group_by(school_name) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
# 97 schools.
```

# Findings From Our Data
I deleted a row because the school -- Northern Illinois -- had been entered twice. There were different entries. The first entry included the lack of a policy. The second entry said there was a policy. I removed the first row. That row is still in the original sheet in Google Sheets. 

As of Nov. 30, 2022, we have heard back from 97 schools. 64 of those schools (66%) are in states where sports gambling and betting is legal. 33 of the 64 schools do have a policy. 31 of the 64 schools don't. 

```{r}
# How many schools are in legal states?
uni_policies_updated %>% 
  filter(legal_illegal == "legal") %>% 
  group_by(school_name) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
# 64 schools, out of 97. 

# Calculating the percentage of legal schools
legal_schools_pct = (64/97)*100
# 65.98% ~ 66%

# How many of those schools have a policy? How many don't?
uni_policies_updated %>% 
  filter(legal_illegal == "legal") %>% #this gives us 64 schools
  group_by(school_policy_exist) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
# 33 of the 64 schools do have a policy. 31 of the 64 schools don't. 

# Calculating the percentage of schools with and without policies
legal_policies_pct = (33/64)*100            # 51.56% ~ 52%
legal_no_policies_pct = (31/64)*100         # 48.43% ~ 48%
total_legal_policies_pct = (33/97)*100      # 34.02% ~ 34%
total_legal_no_policies_pct = (31/97)*100   # 31.95% ~ 32%

# How many of those 64 legal schools allow sports betting? How many don't?
uni_policies_updated %>% 
  filter(legal_illegal == "legal") %>% #this gives us 64 schools
  group_by(allowed) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
# 42 schools do not allow sports betting. 19 do, and 3 are unclear. 

# Calculating the percentage of schools that allow and don't allow sports betting
legal_allowed_pct = (19/64)*100             # 29.68% ~ 30%
legal_not_allowed_pct = (42/64)*100         # 65.62% ~ 65%
total_legal_allowed_pct = (19/97)*100       # 19.54% ~ 20%
total_legal_not_allowed_pct = (42/97)*100   # 43.29% ~ 43%

# What legal states are we not hearing from?
# Legal states are: Arizona, Arkansas, Colorado, Connecticut, Delaware, Illinois, Indiana, Iowa,         Kansas, Louisiana, Maine, Maryland, Massachusetts, Michigan, Mississippi, Montana, Nebraska, Nevada    New Hampshire, New Jersey, New Mexico, New York, North Carolina, North Dakota, Ohio, Oregon,           Pennsylvania, Rhode Island, South Dakota, Tennessee, Virginia, Washington, West Virginia, Wisconsin,   Wyoming. 

uni_policies_updated %>% 
  filter(legal_illegal == "legal") %>%
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(state)

# We're not hearing from Arkansas, Delaware, Maine, Massachusetts, Michigan, Montana, Nevada, New Hampshire, New Jersey, Pennsylvania, Rhode Island. These are all legal states. 

```

# US Dept of Ed's Data

We decided to join our policy data to the student debt data provided by the US Dept of Ed's database -- College Scoreboard. We wanted to see if there's a correlation between the student loan debt at each school and the policy of the school by merging the two datasets together. 

```{r}
# Loading in the data from College Scoreboard
college_data <- read_csv("recent_cohort_institution.csv")

# Selecting specific columns from our data to later join with debt data. 
uni_w_debt <- uni_policies_updated %>% 
  select(school, school_name, state, state_abb, legal_illegal, school_policy_exist, allowed, 
         campus_allowed, covered)

# Choosing specific schools based on what we already have for joining. 
responded_schools <- college_data %>% 
  filter(INSTNM == "California State University-Fresno" | 
           INSTNM == "University of Southern Mississippi" |
           INSTNM == "Wright State University-Main Campus" |
           INSTNM == "Louisiana Tech University" |
           INSTNM == "Kennesaw State University" |
           INSTNM == "University of California-Berkeley" |
           INSTNM == "Winthrop University" |
           INSTNM == "Bowling Green State University-Main Campus" |
           INSTNM == "University of Georgia" |
           INSTNM == "University of South Carolina-Upstate" |
           INSTNM == "California State University-Bakersfield" |
           INSTNM == "University of Cincinnati-Main Campus" |
           INSTNM == "Clemson University" |
           INSTNM == "Georgia Institute of Technology-Main Campus" |
           INSTNM == "University of South Carolina-Columbia" |
           INSTNM == "California State University-Fullerton" |
           INSTNM == "Youngstown State University" |
           INSTNM == "Florida State University" |
           INSTNM == "University of South Dakota" |
           INSTNM == "South Dakota State University" |
           INSTNM == "University of Minnesota-Twin Cities" |
           INSTNM == "North Carolina A & T State University" |
           INSTNM == "George Mason University" |
           INSTNM == "Longwood University" |
           INSTNM == "Oklahoma State University-Main Campus" |
           INSTNM == "Grambling State University" |
           INSTNM == "Morehead State University" |
           INSTNM == "Coppin State University" |
           INSTNM == "Miami University-Oxford" |
           INSTNM == "University of Connecticut" |
           INSTNM == "University of Central Florida" |
           INSTNM == "Florida International University" |
           INSTNM == "University of Northern Iowa" |
           INSTNM == "Southern University and A & M College" |
           INSTNM == "University of Nebraska-Lincoln" |
           INSTNM == "Northwestern State University of Louisiana" |
           INSTNM == "University of New Orleans" |
           INSTNM == "University of Louisiana at Lafayette" |
           INSTNM == "Idaho State University" |
           INSTNM == "University of Kansas" |
           INSTNM == "College of Charleston" |
           INSTNM == "Citadel Military College of South Carolina" |
           INSTNM == "Radford University" |
           INSTNM == "William & Mary" |
           INSTNM == "James Madison University" |
           INSTNM == "University of Virginia-Main Campus" |
           INSTNM == "Old Dominion University" |
           INSTNM == "University of North Carolina at Charlotte" |
           INSTNM == "Virginia Commonwealth University" |
           INSTNM == "Virginia Polytechnic Institute and State University" |
           INSTNM == "Western Carolina University" |
           INSTNM == "Eastern Washington University" |
           INSTNM == "Northern Arizona University" |
           INSTNM == "Arizona State University Campus Immersion" |
           INSTNM == "University of California-Riverside" |
           INSTNM == "San Jose State University" |
           INSTNM == "California State University-Long Beach" |
           INSTNM == "Eastern Illinois" |
           INSTNM == "Virginia Military Institute" |
           INSTNM == "University of Northern Colorado" |
           INSTNM == "Kansas State University" |
           INSTNM == "University of Oregon" |
           INSTNM == "Georgia Southern University" |
           INSTNM == "Illinois State University" |
           INSTNM == "Northern Illinois University" |
           INSTNM == "University of Vermont" |
           INSTNM == "University of Florida" |
           INSTNM == "Florida Gulf Coast University" |
           INSTNM == "University of North Florida" |
           INSTNM == "Louisiana State University and Agricultural & Mechanical College" |
           INSTNM == "University of North Dakota" |
           INSTNM == "Southern Illinois University-Carbondale" |
           INSTNM == "University of Toledo" |
           INSTNM == "Western Illinois University" |
           INSTNM == "University of Illinois Chicago" |
           INSTNM == "Southern Illinois University-Edwardsville" |
           INSTNM == "University of Illinois Urbana-Champaign" |
           INSTNM == "University of Idaho" |
           INSTNM == "University of California-Los Angeles" |
           INSTNM == "University of California-Irvine" |
           INSTNM == "San Diego State University" |
           INSTNM == "Washington State University" |
           INSTNM == "University of New Mexico-Main Campus" |
           INSTNM == "University of Iowa" |
           INSTNM == "Purdue University-Main Campus" |
           INSTNM == "Indiana State University" |
           INSTNM == "Indiana University-Bloomington" |
           INSTNM == "Oregon State University" |
           INSTNM == "Portland State University" |
           INSTNM == "SUNY at Albany" |
           INSTNM == "University at Buffalo" |
           INSTNM == "Stony Brook University" |
           INSTNM == "University of Wyoming" |
           INSTNM == "Chicago State University" |
           INSTNM == "Central Connecticut State University" |
           INSTNM == "Mississippi Valley State University")

# Selecting the debt columns from the new database
debt_responded_schools <- responded_schools %>% 
  select(INSTNM, DEBT_MDN, GRAD_DEBT_MDN, WDRAW_DEBT_MDN, LO_INC_DEBT_MDN, MD_INC_DEBT_MDN, 
         HI_INC_DEBT_MDN, DEP_DEBT_MDN, IND_DEBT_MDN, PELL_DEBT_MDN, NOPELL_DEBT_MDN, FEMALE_DEBT_MDN,
         MALE_DEBT_MDN, FIRSTGEN_DEBT_MDN, NOTFIRSTGEN_DEBT_MDN, DEBT_N, GRAD_DEBT_N, WDRAW_DEBT_N,
         LO_INC_DEBT_N, MD_INC_DEBT_N, HI_INC_DEBT_N, DEP_DEBT_N, IND_DEBT_N, PELL_DEBT_N, 
         NOPELL_DEBT_N, FEMALE_DEBT_N, MALE_DEBT_N, FIRSTGEN_DEBT_N, NOTFIRSTGEN_DEBT_N, 
         GRAD_DEBT_MDN10YR, CUML_DEBT_N, CUML_DEBT_P90, CUML_DEBT_P75, CUML_DEBT_P25, CUML_DEBT_P10)  

# Joining the two datasets together
uni_w_debt <- uni_w_debt %>% 
  left_join(debt_responded_schools, by=c('school_name'='INSTNM'))

# Checking to see the exact number of schools
uni_w_debt %>% 
  group_by(school_name) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
#97 schools.
```

# Findings From Their Data & Ours

TBA

```{r}

```


##### Ignore below...

```{r}
all_schools <- read_csv("list_of_school_states.csv")

all_schools <- all_schools %>% 
  clean_names()

all_schools <- all_schools %>% 
  mutate(legal_illegal = case_when(
    state == 'Alabama' | state == 'Alaska' | state == 'California' | state == 'Florida' |
    state == 'Georgia' | state == 'Hawaii' | state == 'Idaho' | state == 'Kentucky' | 
    state == 'Minnesota' | state == 'Missouri' | state == 'Oklahoma' | state == 'South Carolina' | state == 'Texas' | state == 'Utah' | state == 'Vermont' ~ "illegal",
    state == 'Arizona' | state == 'Arkansas' | state == 'Colorado' | state == 'Connecticut' |
    state == 'Delaware' | state == 'Illinois' | state == 'Indiana' | state == 'Iowa' | state
    == 'Kansas' | state == 'Louisiana' | state == 'Maine' | state == 'Maryland' | state ==
    'Massachusetts' | state == 'Michigan' | state == 'Mississippi' | state == 'Montana' |
    state == 'Nebraska' | state == 'Nevada' | state == 'Las Vegas' | state == 'New Hampshire'
    | state == 'New Jersey'
    | state == 'New Mexico' | state == 'New York' | state == 'North Carolina' | state ==
    'North Dakota' | state == 'Ohio' | state == 'Oregon' | state == 'Pennsylvania' | state ==
    'Rhode Island' | state == 'South Dakota' | state == 'Tennessee' | state == 'Tennesse' |
    state == 'Virginia' | state == 'Washington' | state == 'West Virginia' | state ==
    'Wisconsin' | state == 'Wyoming' ~ "legal"))

#I need to clean this data, Las Vegas is a state, and Tennesse, not Tennessee, is also a state.  

all_schools %>% 
  group_by(legal_illegal) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

gambling_policy_tracker %>% 
  group_by(legal_illegal) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

gambling_policy_tracker %>% 
  filter(legal_illegal == "legal") %>% 
  group_by(allowed) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

# Total = 42, no = 28, yes = 13. 

prohibited_perc = (28/42)*100

```

## Regional Figures

```{r}
gambling_policy_tracker <- gambling_policy_tracker %>% 
  mutate(region = case_when(
    state == 'CT' | state == 'ME' | state == 'MA' | state == 'NH' | state == 'RI' |
    state == 'VT' | state == 'NJ' | state == 'NY' | state == 'PA' ~ "Northeast",
    state == 'IN' | state == 'IL' | state == 'MI' | state == 'OH' | state == 'WI' |
    state == 'IA' | state == 'NE' | state == 'KS' | state == 'ND' | state == 'MN' |
    state == 'SD' | state == 'MO' ~ "Midwest",
    state == 'DE' | state == 'FL' | state == 'GA' | state == 'MD' | state == 'NC' |
    state == 'SC' | state == 'VA' | state == 'WV' | state == 'AL' | state == 'KY' |
    state == 'MS' | state == 'TN' | state == 'AR' | state == 'LA' | state == 'OK' |
    state == 'TX' ~ "South",
    state == 'AZ' | state == 'CO' | state == 'ID' | state == 'NM' | state == 'MT' |
    state == 'UT' | state == 'NV' | state == 'WY' | state == 'AK' | state == 'CA' |
    state == 'HI' | state == 'OR' | state == 'WA' ~ "West"))


gambling_policy_tracker %>% 
  filter(legal_illegal == "legal") %>% 
  group_by(region) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

gambling_policy_tracker %>% 
  filter(legal_illegal == "legal" & allowed == "No") %>% 
  group_by(region) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

```

##### Analysis as of 11/9/2022

```{r}
# Read in the data.
gambling_policy_tracker <- read_csv("gambling_policy_tracker_updated.csv")

# Cleaning column names
gambling_policy_tracker <- gambling_policy_tracker %>% 
  clean_names() %>% 
  rename(school_policy_exist = does_the_school_have_a_policy_on_sports_gambling_betting_that_extends_beyond_ncaa_policy) %>% 
  rename(allowed = is_sports_gambling_betting_allowed) %>% 
  rename(state_law = does_the_response_cite_state_law) %>% 
  rename(covered = who_is_covered) %>% 
  rename(campus_allowed = is_sports_gambling_allowed_on_or_off_campus) %>% 
  rename(detail = detail_if_there_isnt_any_detail_put_n_a) %>% 
  rename(interesting = rate_the_policys_interestingness_on_a_scale_from_1_5) %>% 
  rename(specifics = give_specific_key_words_or_phrases) %>% 
  rename(advert_policy_exist = does_the_school_have_a_policy_on_the_advertising_or_promotion_of_gambling_or_gaming_products_and_services) %>% 
  rename(detail_advert = briefly_describe_the_advertising_policy_if_theres_no_policy_or_its_unclear_please_put_n_a)

gambling_policy_tracker <- gambling_policy_tracker[-c(33, 34), ]
```

## States that make sport betting illegal

https://www.washingtonpost.com/sports/2022/08/29/sports-betting-laws-by-state/ 

Question: Some states are illegal in person, but allowed online. Are we taking that into consideration?

```{r}
gambling_policy_tracker <- gambling_policy_tracker %>% 
  mutate(legal_illegal = case_when(
    state == 'AL' | state == 'AK' | state == 'CA' | state == 'FL' | state == 'GA' | 
    state == 'HI' | state == 'ID' | state == 'KY' | state == 'MN' | state == 'MO' | 
    state == 'OK' | state == 'SC' | state == 'TX' | state == 'UT' | state == 'VT' ~
    "illegal",
    state == 'AZ' | state == 'AR' | state == 'CO' | state == 'CT' | state == 'DE' | 
    state == 'IL' | state == 'IN' | state == 'IA' | state == 'KS' | state == 'LA' |
    state == 'ME' | state == 'MD' | state == 'MA' | state == 'MI' | state == 'MS' |
    state == 'MT' | state == 'NE' | state == 'NV' | state == 'NH' | state == 'NJ' |
    state == 'NM' | state == 'NY' | state == 'NC' | state == 'ND' | state == 'OH' | 
    state == 'OR' | state == 'PA' | state == 'RI' | state == 'SD' | state == 'TN' |
    state == 'VA' | state == 'WA' | state == 'WV' | state == 'WI' | state == 'WY' ~ 
    "legal"))
```

### Mark's Questions


```{r}
# Pie Chart of schools responded vs, schools not responded: 

schools <- data.frame(
  group = c("responsive_schools", "unresponsive_schools"),
  value = c(69, 162)
  )

pie(schools$value, labels = schools$group)

# Compute the position of labels
schools <- schools %>% 
  arrange(desc(group)) %>%
  mutate(percent = value / sum(schools$value) *100) %>%
  mutate(ypos = cumsum(percent)- 0.5*percent ) %>% 
  mutate(percent = round(schools$percent, digits = 1))

# Basic piechart
ggplot(schools, aes(x="", y=percent, fill=group)) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start=0) +
  theme_void() +
  geom_text(aes(y = ypos, label = percent), color = "white", size=6) +
  labs(title = 
  "Out of 231 schools, we have heard back from 69 of them, 
                causing a remainder of 162 schools.") 



```

```{r}
### Schools that are in states where sports betting is legalized. 

gambling_policy_tracker %>% 
  filter(legal_illegal == "legal")

legal_schools <- gambling_policy_tracker %>%
  group_by(legal_illegal) %>% 
  summarise(count = n()) %>% 
  mutate(percentage = (count/69)*100) %>% 
  mutate(percentage = round(legal_schools$percentage, digits = 1)) 

legal_schools %>%   
  ggplot() +
  geom_bar(aes(x=reorder(legal_illegal, count), weight=count), fill = "blue") +
  coord_flip() + 
  geom_text(aes(x=legal_illegal, y=count, label = percentage), hjust=1.5, vjust=0,
            colour = "white") + 
  labs(
    title="No & Percentage of schools in states where sports betting is illegal and legal",
    x = "States",
    y = "Count (#)"
  )

# Out of the 69 schools we've heard from, 42 of them are in states where sports betting is legalized. 



### Schools that are in states where sports betting is allowed, and have a policy on sports betting. 
gambling_policy_tracker %>% 
  filter(legal_illegal == "legal") %>% 
  filter(school_policy_exist == "Yes")

pctg = (16/69)*100

# Out of those 42, only 16 of those schools have a policy on sports betting. The percentage i2 23.2


### Top 5 states where sports betting is legal, and we've heard back from their schools. 
schools_in_legal_states <- gambling_policy_tracker %>% 
  filter(legal_illegal == "legal") %>% 
  group_by(state) %>% 
  summarise(num_states = n()) %>% 
  arrange(desc(num_states)) %>% 
  mutate(pcent = (num_states/69)*100) %>% 
  head(5) %>% 
  mutate(pcent = round(schools_in_legal_states$pcent, digits = 1))

schools_in_legal_states %>% 
  ggplot() +
  geom_bar(aes(x=reorder(state, num_states), weight=num_states), fill = "blue") +
  coord_flip() + 
  geom_text(aes(x=state, y=num_states, label = pcent), hjust=1.5, vjust=0,
            colour = "white") + 
  labs(
    title="Top 5 Percentages of schools in states we've heard back from where 
    sports betting is legal",
    x = "States",
    y = "Count (#)"
  )


### Top 5 states where sports betting is legal and those schools in that state have a policy.
legal_schools_policies <- gambling_policy_tracker %>% 
  filter(legal_illegal == "legal" & school_policy_exist == "Yes") %>% 
  group_by(state) %>% 
  summarise(num_states = n()) %>% 
  arrange(desc(num_states)) %>% 
  mutate(pct = (num_states/69)*100) %>% 
  head(5) %>% 
  mutate(pct = round(legal_schools_policies$pct, digits = 1))

legal_schools_policies %>% 
  ggplot() +
  geom_bar(aes(x=reorder(state, num_states), weight=num_states), fill = "blue") +
  coord_flip() + 
  geom_text(aes(x=state, y=num_states, label = pct), hjust=1.5, vjust=0,
            colour = "white") + 
  labs(
    title="Percentages of the states where sports betting is legal, and schools have a
    policy",
    x = "States",
    y = "Count (#)"
  )
```

##### Older Analysis

## State

As of Nov 1, 2022, ten Virginia schools have gotten back to us regarding whether or not they have a sports betting policy, the highest of the other schools. California comes in with eight, Louisiana comes in with six, and Florida, Ohio, and South Carolina come in with five each. 

I looked into the ten schools from Virginia (which are all done by the homie Derek), and eight of them don't have a policy that extends beyond NCAA policies, but one of the schools have policy on advertising in Virginia, which is Radford. As for the schools that do have a policy beyond NCAA, one interesting school from Virginia (James Madison), makes illegal betting prhibited, but students can bet in their own dorms. 

```{r}
# state responses
gambling_policy_tracker %>% 
  group_by(state) %>% 
  summarise(no_of_policy = n()) %>% 
  arrange(desc(no_of_policy))

# VA had the most, so look into those schools. 
gambling_policy_tracker %>% 
  filter(state == "VA" & school_policy_exist == "No")
gambling_policy_tracker %>% 
  filter(state == "VA" & school_policy_exist == "Yes")

# CA
gambling_policy_tracker %>% 
  filter(state == "CA")

# LA
gambling_policy_tracker %>% 
  filter(state == "LA" & interesting == "4") %>% 
  select(detail) %>% 
  view()

# FL
gambling_policy_tracker %>% 
  filter(state == "FL")

# OH
gambling_policy_tracker %>% 
  filter(state == "OH")

# SC
gambling_policy_tracker %>% 
  filter(state == "SC")

gambling_policy_tracker %>% 
  filter(school_policy_exist == "Yes") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% # neither = 33, both = 17, off = 16, on = 2
  ggplot() +
  geom_bar(aes(x=reorder(state,count), weight=count), fill = "blue") +
  coord_flip() + 
  labs(
    title="Where is sports betting mainly allowed?",
    x = "",
    y = "amount"
  ) 
```

## Existence of a school policy that extends beyond NCAA

```{r}
gambling_policy_tracker %>% 
  group_by(school_policy_exist) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% # no = 37, yes = 28, unclear = 3
  ggplot() +
  geom_bar(aes(x=reorder(school_policy_exist,count), weight=count), fill = "blue") +
  coord_flip() + 
  labs(
    title="Existence of sports betting policies",
    x = "",
    y = "amount"
  ) 

gambling_policy_tracker %>% 
  filter(school_policy_exist == "No") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
```

## The number of schools that allow it

```{r}
gambling_policy_tracker %>% 
  group_by(allowed) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% # no = 49, yes = 17, unclear = 2
  ggplot() +
  geom_bar(aes(x=reorder(allowed,count), weight=count), fill = "blue") +
  coord_flip() + 
  labs(
    title="Number of schools that allow or don't allow sports betting",
    x = "",
    y = "amount"
  ) 

gambling_policy_tracker %>% 
  filter(allowed == "Yes" & state == "FL") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
```

## Mention of state law

```{r}
gambling_policy_tracker %>% 
  group_by(state_law) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% # no = 44, yes = 24
  ggplot() +
  geom_bar(aes(x=reorder(state_law,count), weight=count), fill = "blue") +
  coord_flip() + 
  labs(
    title="Number of schools that mentioned or didn't mention state law",
    x = "",
    y = "amount"
  ) 

gambling_policy_tracker %>% 
  filter(state_law == "No") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
```

```{r}
gambling_policy_tracker %>% 
  group_by(covered) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% # all = 52, on-campus = 12, athletes = 4
  ggplot() +
  geom_bar(aes(x=reorder(covered,count), weight=count), fill = "blue") +
  coord_flip() + 
  labs(
    title="Type of students that are covered in the policy",
    x = "",
    y = "amount"
  ) 

# the student athletes had to be before the change, reminder that no one should be putting information in the form spreadsheet, only use the form.

gambling_policy_tracker %>% 
  filter(covered == "All") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
```

## Campus allowed

```{r}
gambling_policy_tracker %>% 
  group_by(campus_allowed) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% # neither = 33, both = 17, off = 16, on = 2
  ggplot() +
  geom_bar(aes(x=reorder(campus_allowed,count), weight=count), fill = "blue") +
  coord_flip() + 
  labs(
    title="Where is sports betting mainly allowed?",
    x = "",
    y = "amount"
  ) 

gambling_policy_tracker %>% 
  filter(campus_allowed == "Neither") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
```

## Existence of an advertising policy 

```{r}
gambling_policy_tracker %>% 
  group_by(advert_policy_exist) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% # no = 51, unclear = 13, yes = 4
  ggplot() +
  geom_bar(aes(x=reorder(advert_policy_exist,count), weight=count), fill = "blue") +
  coord_flip() + 
  labs(
    title="The number of schools that have or don't have an advertising policy",
    x = "",
    y = "amount"
  ) 

gambling_policy_tracker %>% 
  filter(advert_policy_exist == "No") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
```
# Interesting

```{r}
gambling_policy_tracker %>% 
  group_by(interesting) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% # 1 = 26, 2 = 20, 3 = 17, 4 = 4, 5 = 1
  ggplot() +
  geom_bar(aes(x=reorder(interesting,count), weight=count), fill = "blue") +
  coord_flip() + 
  labs(
    title="Interestingness scale",
    x = "",
    y = "amount"
  ) 

gambling_policy_tracker %>% 
  filter(interesting == "5") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

gambling_policy_tracker %>% 
  filter(interesting == "4") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

gambling_policy_tracker %>% 
  filter(interesting == "3") %>% 
  group_by(state) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

```

## Result?

Virginia kept coming up when looking at which states have the highest of the highest answer to the questions asked. But it didn't come up when looking at potential interesting states.