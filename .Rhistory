wv_crime <- read.csv("https://raw.githubusercontent.com/dwillis/wvu-projects/master/crime-log/crime_log.csv") %>%
clean_names()
wv_crime <- wv_crime %>%
mutate(datetime = mdy_hm(datetime)) %>%
mutate(date = date(datetime), hour= hour(datetime), day_of_week = wday(date))
wv_crime <- wv_crime %>%
arrange(desc(date))
latest_date <- wv_crime %>% slice(1)
title_latest <- latest_date %>%  select(title) %>% slice(1)
past_30_days <- wv_crime %>% filter(date > latest_date$date - 30)
number_30 <- past_30_days %>%
filter(title == latest_date$title) %>%
summarise(title=n())
sub <- paste("The lastest crime occurred on", format(latest_date$date, format="%B %d"),".", "The crime,", latest_date$title, ", occurred", number_30$title, "times in the past month")
sub
md_zips <- get_acs(geography = "zcta",
variables = c(zip = "B02001_001"),
state = "MD",
year = 2019,
geometry = TRUE)
md_zips <- md_zips %>% mutate(across(GEOID, as.numeric))
md_joined <- maryland_vax %>%
left_join(md_zips, by=c('ZIP_CODE' = 'GEOID'))
md_joined <- maryland_zips %>%
left_join(md_zips, by=c('ZIP_CODE' = 'GEOID'))
View(md_zips)
md_joined <- maryland_zips %>%
left_join(md_zips, by=c('zip_code' = 'GEOID'))
md_joined <- maryland_zips %>%
left_join(md_zips, by=c('GEOID' = 'zip_code'))
wv_police_incidents <- read_csv("https://raw.githubusercontent.com/dwillis/wvu-projects/master/crime-log/crime_log.csv") %>%
mutate(datetime = mdy_hm(datetime))
wv_police_incidents <- wv_police_incidents %>%
mutate(date = date(datetime)) %>%
mutate(time = hour(datetime)) %>%
mutate(dayofweek = wday(date)) %>%
arrange(desc(date))
latest_date <- wv_police_incidents %>% slice(1)
last_30_days <- wv_police_incidents %>% filter(date >= latest_date$date - 30 & title == latest_date$title)
count = count(last_30_days)
sub <- paste("Since",format(latest_date$date, format="%B %d"), "there have been", count, str_to_lower(latest_date$title), "in the last 30 days")
sub
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Desktop/GitHub/Personal/sports_betting_campus_data")
knitr::opts_chunk$set(echo = TRUE)
# Turn off scientific notation
options(scipen=999)
# Load the tidyverse.
library(tidyverse)
# Read in the data.
gambling_policy_tracker <- read_rds("/gambling_policy_tracker.csv")
# Read in the data.
gambling_policy_tracker <- read_csv("/gambling_policy_tracker.csv")
# Read in the data.
gambling_policy_tracker <- read_csv("gambling_policy_tracker.csv")
View(gambling_policy_tracker)
library(janitor)
gambling_policy_tracker <- gambling_policy_tracker %>%
clean_names()
View(gambling_policy_tracker)
View(gambling_policy_tracker)
gambling_policy_tracker <- gambling_policy_tracker %>%
clean_names() %>%
rename(school_policy_exist = does_the_school_have_a_policy_on_sports_gambling_betting_that_extends_beyond_ncaa_policy) %>%
rename(allowed = is_sports_gambling_betting_allowed) %>%
rename(state_law = does_the_response_cite_state_law) %>%
rename(covered = who_is_covered) %>%
rename(campus_allowed = is_sports_gambling_allowed_on_or_off_campus) %>%
rename(detail = detail_if_there_isnt_any_detail_put_n_a) %>%
rename(interesting = rate_the_policys_interestingness_on_a_scale_from_1_5) %>%
rename(specifics = give_specific_key_words_or_phrases) %>%
rename(advert_policy_exist = does_the_school_have_a_policy_on_the_advertising_or_promotion_of_gambling_or_gaming_products_and_services) %>%
rename(detail_advert = briefly_describe_the_advertising_policy_if_theres_no_policy_or_its_unclear_please_put_n_a)
gambling_policy_tracker %>%
group_by(state) %>%
summarise(no_of_policy = n())
gambling_policy_tracker %>%
group_by(state) %>%
summarise(no_of_policy = n()) %>%
arrange(desc(no_of_policy))
gambling_policy_tracker %>%
filter(state == "VA")
gambling_policy_tracker %>%
filter(state == "VA" & school_policy_exist == "No")
gambling_policy_tracker %>%
filter(state == "VA" & school_policy_exist == "Yes")
gambling_policy_tracker %>%
filter(state == "VA" & school_policy_exist == "No")
gambling_policy_tracker %>%
filter(state == "VA" & school_policy_exist == "Yes")
gambling_policy_tracker %>%
filter(state == "CA" & school_policy_exist == "No")
gambling_policy_tracker %>%
filter(state == "CA" & school_policy_exist == "Yes")
gambling_policy_tracker %>%
filter(state == "CA")
gambling_policy_tracker %>%
group_by(state) %>%
summarise(no_of_policy = n()) %>%
arrange(desc(no_of_policy))
gambling_policy_tracker %>%
filter(state == "LA")
gambling_policy_tracker %>%
filter(state == "LA" & interesting = "4")
gambling_policy_tracker %>%
filter(state == "LA" & interesting == "4")
gambling_policy_tracker %>%
filter(state == "LA" & interesting == "4") %>%
view()
gambling_policy_tracker %>%
filter(state == "LA" & interesting == "4") %>%
select(detail)
view()
gambling_policy_tracker %>%
filter(state == "LA" & interesting == "4") %>%
select(detail) %>%
view()
gambling_policy_tracker %>%
filter(state == "FL")
gambling_policy_tracker %>%
filter(state == "OH")
gambling_policy_tracker %>%
filter(state == "CA")
gambling_policy_tracker %>%
filter(state == "VA" & school_policy_exist == "No")
gambling_policy_tracker %>%
group_by(school_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
ggplot() +
geom_bar(aes(x=reorder(school_policy_exist,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Top 10 states by ppp loans per 100,000 people",
x = "State",
y = "Loans per 100K",
caption = "source: SBA PPP loan; U.S. Census."
)
gambling_policy_tracker %>%
group_by(school_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
ggplot() +
geom_bar(aes(x=reorder(school_policy_exist,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Top 10 states by ppp loans per 100,000 people",
x = "State",
y = "Loans per 100K",
caption = "source: SBA PPP loan; U.S. Census."
)
gambling_policy_tracker %>%
group_by(school_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
ggplot() +
geom_bar(aes(x=reorder(school_policy_exist,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Top 10 states by ppp loans per 100,000 people",
x = "State",
y = "Loans per 100K",
caption = "source: SBA PPP loan; U.S. Census."
)
gambling_policy_tracker %>%
group_by(school_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
ggplot() +
geom_bar(aes(x=reorder(school_policy_exist,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Existence of sports betting policies",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
group_by(school_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(school_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 37, yes = 28, unclear = 3
ggplot() +
geom_bar(aes(x=reorder(school_policy_exist,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Existence of sports betting policies",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
group_by(allowed) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 37, yes = 28, unclear = 3
ggplot() +
geom_bar(aes(x=reorder(allowed,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Existence of sports betting policies",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
group_by(allowed) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(allowed) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 49, yes = 17, unclear = 2
ggplot() +
geom_bar(aes(x=reorder(allowed,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Existence of sports betting policies",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
group_by(allowed) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 49, yes = 17, unclear = 2
ggplot() +
geom_bar(aes(x=reorder(allowed,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Number of schools that allow or don't allow sports betting",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
group_by(state_law) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 49, yes = 17, unclear = 2
ggplot() +
geom_bar(aes(x=reorder(state_law,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Number of schools that mentioned or didn't mention state law",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
group_by(state_law) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(state_law) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 44, yes = 24
ggplot() +
geom_bar(aes(x=reorder(state_law,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Number of schools that mentioned or didn't mention state law",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(allowed == "No")
gambling_policy_tracker %>%
filter(allowed == "No") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(school_policy_exist == "No") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(state_law == "No") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(covered) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(covered) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # all = 52, on-campus = 12, athletes = 4
ggplot() +
geom_bar(aes(x=reorder(covered,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Type of students that are covered in the policy",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(covered == "All") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(campus_allowed) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(campus_allowed) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # neither = 33, both = 17, off = 16, on = 2
ggplot() +
geom_bar(aes(x=reorder(campus_allowed,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Where is sports betting mainly allowed?",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(allowed == "Neither") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(allowed == "Neither") %>%
group_by(allowed) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(allowed == "Neither")
gambling_policy_tracker %>%
filter(campus_allowed == "Neither") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(advert_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(advert_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 51, unclear = 13, yes = 4
ggplot() +
geom_bar(aes(x=reorder(advert_policy_exist,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="The number of schools that have or don't have an advertising policy",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(advert_policy_exist == "No") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(interesting) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(interesting) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # 1 = 26, 2 = 20, 3 = 17, 4 = 4, 5 = 1
ggplot() +
geom_bar(aes(x=reorder(interesting,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Interestingness scale",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(interesting == "5" | interesting == "4" | interesting == "3") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(interesting == "5") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(interesting == "5") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(interesting == "4") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(interesting == "3") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
group_by(state) %>%
summarise(no_of_policy = n()) %>%
arrange(desc(no_of_policy))
gambling_policy_tracker %>%
group_by(school_policy_exist) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 37, yes = 28, unclear = 3
ggplot() +
geom_bar(aes(x=reorder(school_policy_exist,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Existence of sports betting policies",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(school_policy_exist == "No") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
```{r}
gambling_policy_tracker %>%
group_by(allowed) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # no = 49, yes = 17, unclear = 2
ggplot() +
geom_bar(aes(x=reorder(allowed,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Number of schools that allow or don't allow sports betting",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(allowed == "No") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(allowed == "No")
gambling_policy_tracker %>%
filter(allowed == "No") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(allowed == "Yes") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count))
gambling_policy_tracker %>%
filter(allowed == "Yes" & state == "FL")
gambling_policy_tracker %>%
group_by(covered) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # all = 52, on-campus = 12, athletes = 4
ggplot() +
geom_bar(aes(x=reorder(covered,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Type of students that are covered in the policy",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
group_by(campus_allowed) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # neither = 33, both = 17, off = 16, on = 2
ggplot() +
geom_bar(aes(x=reorder(campus_allowed,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Where is sports betting mainly allowed?",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # neither = 33, both = 17, off = 16, on = 2
ggplot() +
geom_bar(aes(x=reorder(state,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Where is sports betting mainly allowed?",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(school_policy_exist == "Yes")
gambling_policy_tracker %>%
filter(school_policy_exist == "Yes")
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # neither = 33, both = 17, off = 16, on = 2
ggplot() +
geom_bar(aes(x=reorder(state,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Where is sports betting mainly allowed?",
x = "",
y = "amount"
)
gambling_policy_tracker %>%
filter(school_policy_exist == "Yes") %>%
group_by(state) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>% # neither = 33, both = 17, off = 16, on = 2
ggplot() +
geom_bar(aes(x=reorder(state,count), weight=count), fill = "blue") +
coord_flip() +
labs(
title="Where is sports betting mainly allowed?",
x = "",
y = "amount"
)
